<!DOCTYPE html>
<html lang="et">
  <head>
    <meta charset="utf-8">
    <title>DeltaQR ülevaade</title>
    <script src="qr_overview.js"></script>
    <link rel="stylesheet" href="qr_overview.css">
  </head>
  <body>
    <iframe id="timetable" src="https://docs.google.com/spreadsheets/d/e/2PACX-1vQ2E7QbaMBg0-H06_Lh8RKXcoIaJNo9Ti9oNax_qhaNy2ji_ySlMSphglgJA-8wBFQb6Ipi5ZYoe1WC/pubhtml?gid=1772981667&amp;single=true&amp;widget=true"></iframe>
    <br>
    
    <button onClick="showModal('rant_modal')">...miks see leht selline on?</button>
    
    <div class="modal" id="rant_modal">
      <button class="close_button" onClick="hideModal('rant_modal')">X</button>
      <p>Niisiis, sellel lehel poleks peaaegu midagi olnud. Selle mõistmiseks, miks selline olukord tekkis, tuleb tutvust teha ühe tähtsa veebilehitsejate turvamehanismiga - <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS"><b><i>CORS</i></b></a>-iga.</p>
      <p>Internetis on palju veebilehti. Mitmed veebilehed hoiustavad tähtsaid ja privaatseid andmeid, näiteks panga veebileht või e-maili haldur, kuhu kasutaja on suure tõenäosusega igal hetkel sisse logitud. Samas on ka veebilehti, millele sattudes üritatakse just nendele andmetele kasutaja teadmata ligi pääseda. Teooria selle sooritamiseks on hirmutavalt lihtne: kui kasutaja jõuab kahtlasele veebilehele, käivitub lehel koodilõik, mis pärib huvitava lehe sisu justkui kasutaja eest, seejärel edastab saadud andmed teise päringuga hoiustamiseks mujale. Seega piisabki ühest valest nupuvajutusest veebis, et kogu kontroll oma kontode üle kaotada.</p>
      <p>Õnneks on veebilehitsejate arendamisel sarnaste probleemide lahendamisele väga palju aega kulutatud. Lehtedel ei saa lihtsalt keelata teiste lehtede sisule ligi pääseda, kuna see on vajalik suure osa leheülese funktsionaalsuse toimimiseks. Konkreetse probleemi lahenduse üheks osaks on <b><i>CORS</i></b> - <i>Cross-Origin Resource Sharing</i>. Antud näitel "küsib" veebilehitseja muult lehelt andmete pärimise käigus, millistel lehekülgedel on õigus sealt andmeid pärida. <b>Kui teine leht seda ei täpsusta</b> või päringu esitanud leheosa pole lubatud lehekülgede nimistus, siis veebilehitseja <b>ei edasta</b> andmeid päringu algatajale. Muidugi on teisigi võimalusi üritada piirangutest mööda hiilida, kuid loodetavasti<sup>*</sup> on kõigile neile sarnaselt mõeldud.</p>
      
      <div id="animation_box"><div id="animation_server" class="center_text">Server</div> <div id="animation_browser" class="center_text"><div id="animation_browser_inner">Veebilehitseja</div></div> <div id="animation_page" class="center_text">Lehekülg</div> <div id="animation_data" class="center_text">Päring</div></div>
      
      <p><span title="Ei, konkreetse veebilehe autorid ei ürita teie andmeid varastada.">Seega on kontod veel mõneks hetkeks kaitstud, kuid mis seost on sellel praeguse veebilehega?</span> Peamine probleem on piiranguga, et kui lehekülg pole täpsustanud, kas teistel lehtedel on luba andmetele ligi pääseda, siis tõlgendatakse seda üldise keeluna. Selline <i>opt-in</i> lähenemine tõstab turvalisust, kuid lõhub ka funktsionaalsust mitmete avalikult kättesaadavate andmete piiramisega, kuna tihtipeale jäetakse isegi avalikult ligipääsetavate andmete puhul vastav säte muutmata. <span title="Jah, sinna saab sisse logida, aga mingi avalik otspunkt võiks olemas olla.">Nii on ka DeltaQR andmetele veebilehitseja poolt ligipääs piiratud</span>, mistõttu puhtalt veebilehel töötava lisa loomine osutus võimatuks - mingi server peab andmed pärima ning need kättesaadaval kujul edastama. Antud juhul on selleks serveriks mingi vaene Google'i server, mis iga paari minuti tagant vastava päringu teeb, tulemusi tõlgendab ning tabeli genereerib ja vormistab. Paraku pole see kood (ega tehniliselt tabelgi, mille kättesaamisega tekib sarnane probleem) otseselt veebilehe osa.</p>
      <p>Seega, kui te jagate kunagi veebilehel jooksvaid andmeid, mis on kõigile kättesaadavad, ning suudate selle ohutuse garanteerida, uurige natuke ning lülitage selline andmete jagamine sisse. Ehk teete mõne tudengi õhtu selle võrra pisut lühemaks.</p> 
      <br>
      <p><sup>*</sup> Veebilehitsejate arendajate ning andmepüüdjate (ja teistegi) vahel käib pidev võidujooks vigade leidmiseks ja parandamiseks. Paraku on olemasolevat viga praktiliselt võimalik parandada alles siis, kui see üles leitakse, misjuhul on keegi seda tõenäoliselt juba ära kasutanud...</p>
    </div>
  </body>
</html>
